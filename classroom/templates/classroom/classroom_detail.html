{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% block title %}{{ vc.class_name }} - {{ vc.section|upper }}{% endblock %}

{% block content %}
<div classs="card animate-fade-in-up">
    <div class="page-header">
        <div>
            <h2 class="text-gradient">üè´ {{ vc.class_name }} - {{ vc.section|upper }}</h2>
            <p>{{ vc.school.name }} | {% trans "Total Students" %}: <strong>{{ students.count }}</strong></p>
        </div>
        <a href="{% url 'quick_checkup' vc.id %}" class="btn btn-primary" style="background: var(--color-warning); border-color: var(--color-warning);">
            ü©∫ {% trans "Start Quick Checkup" %}
        </a>
    </div>

    <div class="form-group">
        <label for="studentSearch" class="form-label">üîç {% trans "Search Students" %}</label>
        <input type="text" id="studentSearch" class="form-control" placeholder="{% trans "Search by student name or roll number..." %}">
    </div>

    {% if students %}
    <div class="table-wrapper">
      <table class="data-table">
        <thead>
          <tr>
            <th>{% trans "Roll No" %}</th>
            <th>{% trans "Name" %}</th>
            <th>{% trans "Class" %}</th>
            <th>{% trans "Section" %}</th>
            <th>{% trans "Height (cm)" %}</th>
            <th>{% trans "Weight (kg)" %}</th>
            <th>{% trans "Parent Contact" %}</th>
            <th>{% trans "Address" %}</th>
          </tr>
        </thead>
        <tbody id="studentTable">
          {% for s in students %}
          <tr class="student-row">
            <td>{{ s.roll_no }}</td>
            <td>{{ s.user.first_name }} {{ s.user.last_name }}</td>
            <td>{{ s.class_name }}</td>
            <td>{{ s.section }}</td>
            <td>{{ s.height_cm|default:"--" }}</td>
            <td>{{ s.weight_kg|default:"--" }}</td>
            <td>{{ s.parent_contact|default:"--" }}</td>
            <td>{{ s.address|default:"--" }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
      <p class="text-center text-muted mt-4">{% trans "No students enrolled yet." %}</p>
    {% endif %}
</div>

<style>
    .card { padding: 2.5rem; } /* Extra padding for this page */
    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
        margin-bottom: 2rem;
    }
    .page-header h2 { margin-bottom: 0.25rem; }
    .page-header p { margin-bottom: 0; }
    .text-gradient {
        background: var(--color-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }
    
    /* Table Styling */
    .table-wrapper { overflow-x: auto; border: 1px solid var(--color-border); border-radius: var(--border-radius); }
    .data-table { width: 100%; border-collapse: collapse; text-align: left; }
    .data-table th, .data-table td {
        padding: 0.9rem 1rem;
        border-bottom: 1px solid var(--color-border);
        vertical-align: middle;
    }
    .data-table th {
        font-weight: 600;
        background: var(--color-primary-light);
    }
    .data-table tr:last-child td { border-bottom: none; }
    .data-table tr:hover { background: #fdfdff; }
</style>
{% endblock %}

{% block scripts %}
<script>
document.getElementById("studentSearch").addEventListener("keyup", function() {
  const filter = this.value.toLowerCase();
  document.querySelectorAll(".student-row").forEach(row => {
    const text = row.innerText.toLowerCase();
    row.style.display = text.includes(filter) ? "" : "none";
  });
});
</script>
{% endblock %}